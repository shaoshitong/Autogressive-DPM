[[34m2024-07-05 10:51:53[0m] Experiment directory created at results/000-GPT-B
[[34m2024-07-05 10:51:53[0m] Experiment directory created in cloud at /data/shaoshitong/adm//2024-07-05-10-51-53/000-GPT-B/checkpoints
[[34m2024-07-05 10:51:53[0m] Namespace(code_path='/data/shaoshitong/imagenet_code_c2i_flip_ten_crop', cloud_save_path='/data/shaoshitong/adm/', no_local_save=False, gpt_model='GPT-B', gpt_ckpt=None, gpt_type='c2i', vocab_size=16384, ema=False, cls_token_num=1, dropout_p=0.1, token_dropout_p=0.1, drop_path_rate=0.0, no_compile=False, results_dir='results', dataset='imagenet_code', image_size=256, downsample_size=16, num_classes=1000, epochs=300, lr=0.0001, weight_decay=0.05, beta1=0.9, beta2=0.95, max_grad_norm=1.0, global_batch_size=256, global_seed=0, num_workers=24, log_every=100, ckpt_every=5000, gradient_accumulation_steps=1, mixed_precision='bf16', rank=0, world_size=8, gpu=0, dist_url='env://', distributed=True, dist_backend='nccl')
[[34m2024-07-05 10:51:53[0m] Starting rank=0, seed=0, world_size=8.
[[34m2024-07-05 10:51:55[0m] GPT Parameters: 110,888,448
[[34m2024-07-05 10:51:55[0m] num decayed parameter tensors: 63, with 110,869,248 parameters
[[34m2024-07-05 10:51:55[0m] num non-decayed parameter tensors: 25, with 19,200 parameters
[[34m2024-07-05 10:51:55[0m] using fused AdamW: True
